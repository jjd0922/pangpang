<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.newper.mapper.ConsultationResultMapper">
    <sql id="includeConsultationResultDataTable">
        <if test="CR_TITLE != null and CR_TITLE != ''">AND CR_TITLE LIKE CONCAT('%',#{CR_TITLE},'%')</if>
        <if test="CREATED_DATE != null and CREATED_DATE != ''">AND CREATED_DATE BETWEEN SUBSTR(#{CREATED_DATE}, 1, 10) AND SUBSTR(#{CREATED_DATE}, 13)</if>
    </sql>
    <select id="selectConsultationResultDatatable" resultType="Map" parameterType="Map">
        SELECT
        CR_IDX,
        CR_TITLE,
        CR_MEMO,
        CR_SCRIPT,
        CR_TYPE,
        CREATED_DATE
        FROM
        consultation_result

        <include refid="includeConsultationResultDataTable"></include>

        ORDER BY
        CR_IDX desc
        <if test="length!=-1">
            LIMIT #{start},#{length}
        </if>
    </select>

    <select id="countConsultationResultDatatable" resultType="Integer">
        SELECT
        COUNT(*)
        FROM
        consultation_result
        <include refid="includeConsultationResultDataTable"></include>
    </select>
</mapper>
