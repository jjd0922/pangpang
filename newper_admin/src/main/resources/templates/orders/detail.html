
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title th:text="${order != null}? '주문정보상세':'주문정보등록'"></title>

    <th:block th:replace="common/css.html"></th:block>
    <style>
        .modal-dialog{
            max-width: 950px;
        }

        .table-hover {
            width: 100% !important;
        }

        .form-division{
            display: flex;
            flex-wrap: wrap;
        }
    </style>
</head>

<body>
<!-- 본문 영역 시작 -->
<div class="page-content">
    <div class="content-wrapper">
        <div class="content-inner">
            <div class="page-header page-header-dark">
                <div class="page-header-content container-fluid header-elements-md-inline px-3">
                    <div class="d-flex">
                        <div class="page-title">
                            <h4 class="font-weight-semibold" >주문정보 상세</h4>
                        </div>
                    </div>
                    <div class="">
                        <button type="button" class="" onclick="">문자발송</button>
                        <button type="button" class="" onclick="">카카오톡</button>
                        <button type="button" class="" onclick="">APP PUSH</button>
                    </div>

                </div>
            </div>
            <form id="productForm" class="form-division">
                <div class="content col-xs-12 col-md-6">
                    <div class="card">
                        <div class="card-body popup-contents mb-4">
                            <fieldset class="mb-0">
                                <legend class="">1. 주문, 결제정보 <span class="small ml-2"></span>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="" th:if="${order!=null}">결제완료</button>
                                    <button type="button" class="btn btn-xs bg-success pull-right legitRipple" onclick="" th:if="${order!=null}">결제취소</button>
                                </legend>
                            </fieldset>
                            <div class="row">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               주문완료일
                                            </span>
                                        </span>
                                        <input type="text" name="O_DATE" class="form-control daterange-singlenull" th:value="${order?.O_DATE}" th:disabled="${order!=null}">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               결제상태
                                            </span>
                                        </span>
                                        <select th:if="${order==null}" class="form-control form-control-sm select-search" name="PAY_STATE" data-placeholder="선택" data-container-css-class="select-sm">
                                            <option></option>
                                            <option th:each="opt: ${T(com.newper.constant.PayState).values()}" th:text="${opt.getOption()}" th:value="${opt.name()}"></option>
                                        </select>
                                        <input th:unless="${order==null}" type="text" name="PAY_STATE" class="form-control" th:value="${order?.PAY_STATE_STR}" disabled>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               주문코드
                                            </span>
                                        </span>
                                        <input type="text" name="O_CODE" class="form-control" th:value="${order?.O_CODE}" th:disabled="${order!=null}">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               결제방식
                                            </span>
                                        </span>
                                        <select th:if="${order==null}" class="form-control form-control-sm select-search" name="PAY_METHOD" data-placeholder="선택" data-container-css-class="select-sm">
                                            <option></option>
                                            <option th:each="opt: ${T(com.newper.constant.PayMethod).values()}" th:text="${opt.getOption()}" th:value="${opt.name()}"></option>
                                        </select>
                                        <input th:unless="${order==null}" type="text" name="PAY_METHOD" class="form-control" th:value="${order?.PAY_METHOD}" disabled>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               주문분양몰
                                            </span>
                                        </span>
                                        <select th:if="${order==null}" class="form-control form-control-sm select-search" name="SHOP_IDX" data-placeholder="선택" data-container-css-class="select-sm">
                                            <option></option>
                                            <option th:each="i: ${shop}" th:text="${i.shopName}" th:value="${i.shopIdx}"></option>
                                        </select>
                                        <input th:unless="${order==null}" type="text" name="SHOP_NAME" class="form-control" th:value="${order?.SHOP_NAME}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               PG결제승인코드
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_CODE" class="form-control" th:value="${order?.PAY_CODE}" disabled>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               회원구분
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control" th:value="${order?.CU_IDX}!=null? '회원':'비회원'" disabled th:unless="${order==null}">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               결제일
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_DATE" class="form-control" th:value="${order?.PAY_DATE}" disabled>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               주문자 ID
                                            </span>
                                        </span>
                                        <input type="text" name="CU_ID" class="form-control" th:value="${order?.CU_ID}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               카드결제취소코드
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_CANCEL_CODE" class="form-control" th:value="${order?.PAY_CANCEL_CODE}" disabled>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               주문자 이름
                                            </span>
                                        </span>
                                        <input type="text" name="CU_NAME" class="form-control" th:value="${order?.CU_NAME}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               카드결제취소일
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_CANCEL_DATE" class="form-control" th:value="${order?.PAY_CANCEL_DATE}" disabled>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text ">
                                               주문자 연락처
                                            </span>
                                        </span>
                                        <input type="text" name="CU_PHONE" class="form-control" th:value="${order?.CU_PHONE}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               주문경로
                                            </span>
                                        </span>
                                        <input type="text" name="O_LOCATION" class="form-control" th:value="${order?.O_LOCATION}" disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content col-xs-12 col-md-6">
                    <div class="card">
                        <div class="card-body popup-contents mb-4">
                            <fieldset class="mb-0">
                                <legend class="">2. 주문, 결제정보 <span class="small ml-2"></span>
                                </legend>
                            </fieldset>
                            <div class="row">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               판매가(뉴퍼마켓가) 합
                                            </span>
                                        </span>
                                        <input type="text" name="O_GS_PRICE" class="form-control" th:value="${order?.O_GS_PRICE}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               환불은행
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               할인가 합
                                            </span>
                                        </span>
                                        <input type="text" name="O_EVENT" class="form-control" th:value="${order?.O_EVENT}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               환불계좌번호
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                                쿠폰할인가 합
                                            </span>
                                        </span>
                                        <input type="text" name="O_COUPON" class="form-control" th:value="${order?.O_COUPON}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               환불예금주
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               사용적립금(마일리지) 합
                                            </span>
                                        </span>
                                        <input type="text" name="O_MILEAGE" class="form-control" th:value="${order?.O_MILEAGE}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               환불처리금액합계
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               사용적립금(예치금)
                                            </span>
                                        </span>
                                        <input type="text" name="O_POINT" class="form-control" th:value="${order?.O_POINT}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">

                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               배송비(설치비) 합
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_DELIVERY" class="form-control" th:value="${order?.PAY_DELIVERY}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               예정적립금합
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_MILEAGE" class="form-control" th:value="${order?.PAY_MILEAGE}" disabled>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text ">
                                               최종결제금액
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_PRICE" class="form-control" th:value="${order?.PAY_PRICE}" disabled>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               결제취소금액
                                            </span>
                                        </span>
                                        <input type="text" name="PAY_CANCEL_PRICE" class="form-control" th:value="${order?.PAY_CANCEL_PRICE}" disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content col-xs-12 col-md-6">
                    <div class="card">
                        <div class="card-body popup-contents mb-4">
                            <fieldset class="mb-0">
                                <legend class="">3. 배송/설치정보 <span class="small ml-2"></span>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="daum_address1()">배송지정보변경</button>
                                </legend>
                            </fieldset>
                            <div class="row">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               배송자(설치자) 이름
                                            </span>
                                        </span>
                                        <input type="text" name="AD_NAME" class="form-control" th:value="${order?.AD_NAME}">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               배송/설치메세지
                                            </span>
                                        </span>
                                        <input type="text" name="AD_MEMO" class="form-control" th:value="${order?.AD_MEMO}">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               배송자(설치자) 연락처
                                            </span>
                                        </span>
                                        <input type="text" name="AD_PHONE" class="form-control" th:value="${order?.AD_PHONE}">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">

                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               배송자(설치자) 우편번호
                                            </span>
                                        </span>
                                        <input type="text" name="POST" class="form-control"  th:value="${orders != null} ? ${orders.address.post}" readonly>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                                배송자(설치자) 주소(시,도)
                                            </span>
                                        </span>
                                        <input type="text" name="ADDR1" class="form-control" th:value="${orders != null} ? ${orders.address.addr1}" readonly>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               배송자(설치자) 주소(시,군,구)
                                            </span>
                                        </span>
                                        <input type="text" name="ADDR2" class="form-control" th:value="${orders != null} ? ${orders.address.addr2}" readonly>
<!--                                        <input type="hidden" name="ADDR1" class="form-control" th:value="${order?.ADDR1}">
                                        <input type="hidden" name="ADDR2" class="form-control" th:value="${order?.ADDR2}">
                                        <input type="hidden" name="ADDR3" class="form-control" th:value="${order?.ADDR3}">-->
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                                 배송자(설치자) 주소(도로명)
                                            </span>
                                        </span>
                                        <input type="text" name="ADDR3" class="form-control" th:value="${orders != null} ? ${orders.address.addr3}" readonly>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               배송자(설치자) 주소(상세주소)
                                            </span>
                                        </span>
                                        <input type="text" name="ADDR4" class="form-control" th:value="${orders != null} ? ${orders.address.addr4}">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content col-xs-12 col-md-6">
                    <div class="card">
                        <div class="card-body popup-contents mb-4">
                            <fieldset class="mb-0">
                                <legend class="">4. 반품/수거정보 <span class="small ml-2"></span>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="daum_address2()">배송지정보변경</button>
                                </legend>
                            </fieldset>
                            <div class="row">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               (수거)배송자(설치자) 이름
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               (수거)배송/설치메세지
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               (수거)배송자(설치자) 연락처
                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">

                                            </span>
                                        </span>
                                        <input type="text" name="" class="form-control">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               (수거)배송자(설치자) 우편번호
                                            </span>
                                        </span>
                                        <input type="text" name="OPOST" class="form-control"  th:value="${orders != null} ? ${orders.address.oPost}" readonly>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                                (수거)배송자(설치자) 주소(시,도)
                                            </span>
                                        </span>
                                        <input type="text" name="OADDR1" class="form-control" th:value="${orders != null} ? ${orders.address.oAddr1}" readonly>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               (수거)배송자(설치자) 주소(시,군,구)
                                            </span>
                                        </span>
                                        <input type="text" name="OADDR2" class="form-control" th:value="${orders != null} ? ${orders.address.oAddr2}" readonly>
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                                (수거)배송자(설치자) 주소(도로명)
                                            </span>
                                        </span>
                                        <input type="text" name="OADDR3" class="form-control" th:value="${orders != null} ? ${orders.address.oAddr3}" readonly>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-prepend">
                                            <span class="input-group-text">
                                               (수거)배송자(설치자) 상세주소
                                            </span>
                                        </span>
                                        <input type="text" name="OADDR4" class="form-control" th:value="${orders != null} ? ${orders.address.oAddr4}">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content col-xs-12 overflow-x-hidden">
                    <div class="card overflow-x-scroll">
                        <div class="card-body popup-contents mb-4">
                            <fieldset class="mb-0">
                                <legend class="">
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="">반품요청</button>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="">교환요청</button>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="">관리자반품완료</button>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="">관리자교환완료</button>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="">AS요청</button>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="">환불처리</button>
                                    <button type="button" class="btn btn-xs bg-danger pull-right" onclick="">송장등록</button>

                                </legend>
                            </fieldset>
                            <table class="table table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>선택</th>
                                    <th>주문상품코드</th>
                                    <th>주문상태</th>
                                    <th>환불상태</th>
                                    <th>상품코드</th>
                                    <th>상품명</th>
                                    <th>SHOP상품코드</th>
                                    <th>재고코드</th>
                                    <th>자산코드</th>
                                    <th>옵션1</th>
                                    <th>옵션2</th>
                                    <th>옵션3</th>
                                    <th>자산상태</th>
                                    <th>판매가(뉴퍼마켓가)</th>
                                    <th>할인가</th>
                                    <th>쿠폰할인가(-)</th>
                                    <th>사용적립금(마일리지)(-)</th>
                                    <th>사용적립금(예치금)(-)</th>
                                    <th>배송비(설치비)</th>
                                    <th>최종결제금액</th>
                                    <th>예정적립금</th>
                                    <th>환불금액</th>
                                    <th>출고택배사</th>
                                    <th>출고송장번호</th>
                                    <th>수거택배사</th>
                                    <th>수거송장번호</th>
                                    <th>설치업체</th>
                                    <th>수거업체</th>
                                    <th>주문완료일</th>
                                    <th>배송출고일</th>
                                    <th>배송완료일</th>
                                    <th>설치완료일</th>
                                    <th>구매확정일</th>
                                    <th>설치예정일</th>
                                    <th>주문취소일</th>
                                    <th>반품요청일</th>
                                    <th>반품완료일</th>
                                    <th>환불요청일</th>
                                    <th>사용적립금(마일리지)(-)</th>
                                    <th>사용적립금(예치금)(-)</th>
                                    <th>배송비(설치비)</th>
                                    <th>최종결제금액</th>
                                    <th>예정적립금</th>
                                    <th>환불금액</th>
                                </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="i:${gs}">
                                        <td><input type="checkbox" value="${i?.OG_IDX}"></td>
                                        <td th:text="${i?.P_IDX}"></td>
                                        <td th:text="${i?.O_STATE_STR}"></td>
                                        <td th:text="${i?.PAY_CANCEL_STATE_STR}"></td>
                                        <td th:text="${i?.P_IDX}"></td>
                                        <td th:text="${i?.P_NAME}"></td>
                                        <td th:text="${i?.SP_NAME}"></td>
                                        <td th:text="${i?.GS_CODE}"></td>
                                        <td th:text="${i?.G_AJ_BARCODE}"></td>
                                        <td th:text="${i?.OPTION1}"></td>
                                        <td th:text="${i?.OPTION2}"></td>
                                        <td th:text="${i?.OPTION3}"></td>
                                        <td th:text="${i.containsKey('G_STATE_STR')?i.G_STATE_STR:''}"></td>
                                        <td th:text="${i?.GS_PRICE}"></td>
                                        <td th:text="${i?.DISCOUNT}"></td>
                                        <td th:text="${i?.OG_COUPON}"></td>
                                        <td th:text="${i?.OG_MILEAGE}"></td>
                                        <td th:text="${i?.OG_POINT}"></td>
                                        <td th:text="${i?.DELIVERY}"></td>
                                        <td th:text="${i?.TOTAL}"></td>
                                        <td th:text="${i?.MILEAGE}"></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                </tbody>

                            </table>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <div class="navbar navbar-dark border-bottom-0 border-top d-flex justify-content-between py-2">
            <button type="button" class="btn btn-sm btn-light float-left" onclick="window.close();"><i class="icon-cross2 mr-1"></i>닫기</button>
            <button th:if="${product}==null" onclick="productSave()" type="button" class="btn btn-sm btn-secondary ml-1" id=""><i class="icon-floppy-disk mr-1"></i>저장</button>
            <button th:unless="${product}==null" onclick="productUpdate()" type="button" class="btn btn-sm btn-secondary ml-1" id=""><i class="icon-floppy-disk mr-1"></i>수정</button>
        </div>
    </div>

</div>

<th:block th:replace="product/modal/companyModal.html"/>
<!-- 공통 js -->

<link rel="stylesheet" type="text/css" th:href="@{/assets/css/icons/icomoon/styles.min.css}">
<link rel="stylesheet" type="text/css" th:href="@{/assets/css/all.css}">

<script th:src="@{/assets/js/main/bootstrap.bundle.min.js}"></script>

<!-- 메뉴 호버 -->
<script th:src="@{/assets/js/plugins/buttons/hover_dropdown.min.js}"></script>


<!-- 데이터테이블 -->
<script th:src="@{/assets/js/plugins/tables/datatables/datatables.min.js}"></script>
<script th:src="@{/assets/js/plugins/tables/datatables/extensions/select.min.js}"></script>
<script th:src="@{/assets/js/plugins/tables/datatables/extensions/buttons.min.js}"></script>

<!-- 드래그&드랍 -->
<script th:src="@{/assets/js/demo_pages/extension_dnd.js}"></script>
<script th:src="@{/assets/js/plugins/ui/dragula.min.js}"></script>

<!-- 멀티 선택 (숫자) -->
<script th:src="@{/assets/js/plugins/forms/selects/bootstrap_multiselect.js}"></script>
<script th:src="@{/assets/js/demo_pages/form_multiselect.js}"></script>

<!-- 맞춤 js -->
<script th:src="@{/assets/js/app.js}"></script>
<script th:src="@{/assets/js/common.js}"></script>

<!-- input -->
<script th:src="@{/assets/js/plugins/ui/moment/moment.min.js}"></script>
<script th:src="@{/assets/js/plugins/extensions/jquery_ui/interactions.min.js}"></script>
<script th:src="@{/assets/js/plugins/forms/selects/select2.min.js}"></script>
<script th:src="@{/assets/js/plugins/pickers/daterangepicker.js}"></script>
<script th:src="@{/assets/js/demo_pages/form_select2.js}"></script>
<script th:src="@{/assets/js/demo_pages/picker_date.js}"></script>

<!-- 에디터 -->
<script th:src="@{/assets/js/plugins/editors/summernote/summernote.min.js}"></script>
<script th:src="@{/assets/js/plugins/editors/summernote/lang/summernote-ko-KR.js}"></script>

<!-- 에디터 -->
<script th:src="@{/assets/js/demo_pages/editor_summernote.js}"></script>

<!-- 다음 주소 api -->
<script th:src="@{/assets/js/daum_address.js}"></script>
</body>


<th:block th:replace="modal/summernoteImageModal.html"></th:block>

<script th:inline="javascript">
    function category1(){
        var category = $('select[name=CATE_IDX1]').val();
        $.ajax({
            url:'/product/category/parent.ajax',
            data:'CATE_IDX='+category,
            type:'post',
            async: false,
            success:function (res){
                $('select[name=CATE_IDX2] option').remove();
                $('select[name=CATE_IDX3] option').remove();
                var str = '<option value="">선택</option>';
                $.each(res.data.list,function (i){
                    var result = res.data.list[i]
                    str+='<option value="'+result.CATE_IDX+'">'+result.CATE_NAME+'</option>'
                })
                $('select[name=CATE_IDX2]').append(str);
                $('input[name=P_CATE_IDX]').val(category);
            }
        })
    }

    function category2(){
        var category = $('select[name=CATE_IDX2]').val();
        $.ajax({
            url:'/product/category/parent.ajax',
            data:'CATE_IDX='+category,
            type:'post',
            async: false,
            success:function (res){
                $('select[name=CATE_IDX3] option').remove();
                var str = '<option value="">선택</option>';
                $.each(res.data.list,function (i){
                    var result = res.data.list[i]
                    str+='<option value="'+result.CATE_IDX+'">'+result.CATE_NAME+'</option>'
                })
                $('select[name=CATE_IDX3]').append(str);
                $('input[name=P_CATE_IDX]').val(category);
            }
        })
    }

    function category3(){
        var category = $('select[name=CATE_IDX3]').val();
        $('input[name=P_CATE_IDX]').val(category);
    }

    function selectCompany(row){
        var CT_TYPE = $('input[name=CT_TYPE]').val();
        var rowData = getDatatablemap('companyModalTable', row);

        if(CT_TYPE=='STORE'){
            $('input[name=P_COM_NAME]').val(rowData.COM_NAME);
            $('input[name=P_COM_IDX]').val(rowData.COM_IDX);
        }else if(CT_TYPE==''){
            $('input[name=P_COM_NAME2]').val(rowData.COM_NAME);
            $('input[name=P_COM_IDX2]').val(rowData.COM_IDX);
        }else if(CT_TYPE=='REPAIRING'){
            $('input[name=P_COM_NAME3]').val(rowData.COM_NAME);
            $('input[name=P_COM_IDX3]').val(rowData.COM_IDX);
        }
        $('#searchCompanyModal').modal('hide');
    }

    function optionAdd(){
        var cnt = $('#optCnt').val();
        if(cnt==3){
            alert("옵션은 최대 3개까지 추가할 수 있습니다.");
        }else if(-1<cnt<3){
            cnt++;
            var str ="";
            str+="<tr id='option_"+cnt+"'>";
            str+="<td id='opCnt"+cnt+"'>"+cnt+"</td>";
            str+="<td><input type='text' class='form-control' name='p_option_key"+cnt+"'></td>";
            str+="<td><input type='text' class='form-control' name='p_option_value"+cnt+"' placeholder='옵션속성 ,로 구분'></td>";
            str+="<td><a class='btn btn-sm badge-indigo' id='optionBtn"+cnt+"' onclick='deleteOption("+cnt+")'>삭제</a></td>";

            $('#optCnt').val(cnt);
            $('#option_area').append(str);
        }
    }

    function deleteOption(cnt){
        $('#option_'+cnt).remove();
        if(cnt==1){
            if(document.getElementById("option_2")){
                $('#option_2').attr('id','option_1');
                $('#opCnt2').html(1);
                $('#opCnt2').attr('id','opCnt1');
                $('input[name="p_option_key2"]').attr('name','p_option_key1');
                $('input[name="p_option_value2"]').attr('name','p_option_value1');
                document.getElementById("optionBtn2").setAttribute("onclick","deleteOption(1)")
                $('#optionBtn2').attr('id','optionBtn1')
            }
            if(document.getElementById("option_3")){
                $('#option_3').attr('id','option_2');
                $('#opCnt3').html(2);
                $('#opCnt3').attr('id','opCnt2');
                $('input[name="p_option_key3"]').attr('name','p_option_key2');
                $('input[name="p_option_value3"]').attr('name','p_option_value2');
                document.getElementById("optionBtn3").setAttribute("onclick","deleteOption(2)")
                $('#optionBtn3').attr('id','optionBtn2')
            }

        }else if(cnt==2){
            if(document.getElementById("option_3")){
                $('#option_3').attr('id','option_2');
                $('#opCnt3').html(2);
                $('#opCnt3').attr('id','opCnt2');
                $('input[name="p_option_key3"]').attr('name','p_option_key2');
                $('input[name="p_option_value3"]').attr('name','p_option_value2');
                document.getElementById("optionBtn3").setAttribute("onclick","deleteOption(2)")
                $('#optionBtn3').attr('id','optionBtn2')
            }
        }

        var count = $('#optCnt').val();
        count=count-1;
        $('#optCnt').val(count);
    }

    function productSave(){
        if(confirm("저장하시겠습니까?")){
            var param = new FormData($('#productForm')[0]);
            $.ajax({
                url:'/product/productSave.ajax',
                data: param,
                processData:false,
                contentType:false,
                type:'post',
                success:function(res) {
                    if(res.message.indexOf('저장되었습니다.')!=-1){
                        opener.location.reload();
                        self.close();
                    }
                }
            })
        }
    }

    function productUpdate(){
        if(confirm("수정하시겠습니까?")){
            var param = new FormData($('#productForm')[0]);
            $.ajax({
                url:'/product/'+[[${product?.pIdx}]]+'/productUpdate.ajax',
                type:'post',
                processData:false,
                contentType:false,
                data:param,
                success: function(res){
                    if(res.message.indexOf('저장되었습니다.')!=-1){
                        window.location.reload();
                        opener.location.reload();
                    }
                }
            })
        }
    }

    /** 다음 주소 api사용 , 3. 배송/설치정보 배송지 변경*/
    function daum_address1() {
        new daum.Postcode({
            oncomplete: function (data) {
                var addr = ''; // api에서 받아오는 기본 주소
                var extraAddr = ''; // 도로명일때 참고주소

                // 사용자가 도로명주소, 지번주소 중 어떤 것을 클릭했는지에 따라
                if (data.userSelectedType === 'R') {
                    addr = data.roadAddress;
                    if (data.bname !== '' && /[동|로|가]$/g.test(data.bname)) {
                        extraAddr += data.bname;
                    }

                    if (data.buildingName !== '' && data.apartment === 'Y') {
                        extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }

                    if (extraAddr !== '') {
                        extraAddr = '(' + extraAddr + ')';
                    }
                } else {
                    addr = data.jibunAddress;
                }

                // addr1, addr2 부분을 제외한 기본주소 만들기
                var addr_ = addr.split(' ');
                addr = '';
                for (var i = 2; i < addr_.length; i++) {
                    addr += addr_[i] + ' ';
                }

                $('input[name=POST]').val(data.zonecode).attr("readonly", true);
                $('input[name=ADDR1]').val(data.sido).attr("readonly", true);
                $('input[name=ADDR2]').val(data.sigungu).attr("readonly", true);
                $('input[name=ADDR3]').val(addr + extraAddr).attr("readonly", true);
            }
        }).open();
    }

    /** 다음 주소 api사용 , 4. 반품/수거정보 배송지 변경*/
    function daum_address2() {
        new daum.Postcode({
            oncomplete: function (data) {
                var addr = ''; // api에서 받아오는 기본 주소
                var extraAddr = ''; // 도로명일때 참고주소

                // 사용자가 도로명주소, 지번주소 중 어떤 것을 클릭했는지에 따라
                if (data.userSelectedType === 'R') {
                    addr = data.roadAddress;
                    if (data.bname !== '' && /[동|로|가]$/g.test(data.bname)) {
                        extraAddr += data.bname;
                    }

                    if (data.buildingName !== '' && data.apartment === 'Y') {
                        extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }

                    if (extraAddr !== '') {
                        extraAddr = '(' + extraAddr + ')';
                    }
                } else {
                    addr = data.jibunAddress;
                }

                // addr1, addr2 부분을 제외한 기본주소 만들기
                var addr_ = addr.split(' ');
                addr = '';
                for (var i = 2; i < addr_.length; i++) {
                    addr += addr_[i] + ' ';
                }

                $('input[name=OPOST]').val(data.zonecode).attr("readonly", true);
                $('input[name=OADDR1]').val(data.sido).attr("readonly", true);
                $('input[name=OADDR2]').val(data.sigungu).attr("readonly", true);
                $('input[name=OADDR3]').val(addr + extraAddr).attr("readonly", true);
            }
        }).open();
    }
</script>
<script th:inline="javascript">
    window.onload=function(){
        smImage('#summerNote1');
        smImage('#summerNote2');
        smImage('#summerNote3');

        if([[${cg?.depth}]]!=null){
            if([[${cg?.depth}]]==1){
                $('select[name=CATE_IDX1]').val([[${cg?.CATE_IDX1}]]).trigger('change');
            }else if([[${cg?.depth}]]==2){
                $('select[name=CATE_IDX1]').val([[${cg?.CATE_IDX1}]]).trigger('change');
                $('select[name=CATE_IDX2]').val([[${cg?.CATE_IDX2}]]).trigger('change');
            }else if([[${cg?.depth}]]==3){
                $('select[name=CATE_IDX1]').val([[${cg?.CATE_IDX1}]]).trigger('change');
                $('select[name=CATE_IDX2]').val([[${cg?.CATE_IDX2}]]).trigger('change');
                $('select[name=CATE_IDX3]').val([[${cg?.CATE_IDX3}]]).trigger('change');
            }
        }

    }


    $('#companyModalForm').on('keyup',function(event){
        if(event.keyCode==13){searchCompanyDataTable();return false;}
    });
</script>

</html>
