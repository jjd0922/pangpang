<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.newper.mapper.IamportMapper">
    <select id="selectIamportPgList" resultType="map">
        SELECT
            IPM_IDX, IPM_NAME, IPM_VALUE
            ,IPP_JSON->>'$.img' IMG
        FROM IAMPORT_PG, IAMPORT_METHOD
        WHERE
            IPM_IPP_IDX=IPP_IDX
            AND IPP_ORDER > 0
            AND IPP_TYPE = 'EASY'
        ORDER BY IPP_ORDER
    </select>
    <select id="selectIamportMethodList" resultType="map">
        SELECT
            *
        FROM
            IAMPORT_PG, IAMPORT_METHOD
        WHERE
            IPM_IPP_IDX=IPP_IDX
            AND IPM_ORDER > 0
            AND IPP_ORDER > 0
            AND IPP_TYPE = 'NORMAL'
        ORDER BY IPM_ORDER
    </select>
    <select id="selectIamportMethodDetail" resultType="map">
        SELECT
            IPP_VALUE
            ,CASE
                WHEN IPP_VALUE = 'kcp' THEN CONCAT('kcp.',IPP_JSON->>'$.mid' )
                ELSE IPP_VALUE
            END AS PG
            ,IPM_VALUE
        FROM IAMPORT_METHOD, IAMPORT_PG
        WHERE
            IPP_IDX = IPM_IPP_IDX
            AND IPP_ORDER > 0
            AND IPM_ORDER > 0
            AND IPM_IDX = #{ipm_idx}
    </select>
</mapper>