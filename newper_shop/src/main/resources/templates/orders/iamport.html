<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<script type="text/javascript" th:src="@{/js/core/jquery-3.6.0.min.js}"></script>
<script th:src="@{/js/iamport.payment-1.1.8.js}"></script>

</body>
<script>
    function req(id, req){
        var redirect_url = location.origin+'/orders/result/'+req.merchant_uid;
        req.m_redirect_url=redirect_url;

        var IMP = window.IMP;
        IMP.init(id);
        IMP.request_pay(req, function (rsp) {
            debugger;
            $.ajax({
                url:'/orders/iamport/result.ajax'
                ,type:'post'
                ,contentType: 'application/json'
                ,data: JSON.stringify(rsp)
                ,async:false
            });

            if(rsp.success){
                //결제 성공 페이지로 이동
                location.href = redirect_url;
            }else{
                alert(rsp.error_msg);
            }

        });
    }
</script>
<script>
</script>
</html>