<!--로그인 모달창-->
<th:block th:fragment="login-modal" xmlns:th="">
    <div class="modal-wrap loginModal-wrap">
        <div class="modal loginModal">
            <div class="loginModal-close">
                <img th:attr="src=@{/image/close.png},title='모달창닫기',alt='창닫기'">
            </div>
            <div class="login-content-wrap">
                <div class="login-left">
                    <h2 class="font-lg semi-bold center">로그인</h2>
                    <form id="loginForm" onkeyup="if(event.keyCode==13){login();return false;}">
                        <ul class="login-input-group">
                            <li class="input-wrap">
                                <input type="text" class="form-control" name="id" placeholder="아이디">
                            </li>
                            <li class="input-wrap">
                                <input type="password" class="form-control" name="pw" maxlength="15" placeholder="비밀번호">
                            </li>
                        </ul>
                    </form>
                    <div class="login-check-wrap">
                        <label class="login-check">
                            <input type="checkbox" class="custom-checkbox" id="" name="">
                            자동로그인
                        </label>
                        <ul class="login-find-group">
                            <li>
                                <a href="/customer/findCustomer">아이디/비밀번호 찾기</a>
                            </li>
<!--                            <li>-->
<!--                                <a href="/customer/findCustomer">비밀번호 찾기</a>-->
<!--                            </li>-->
                            <li>
                                <a href="/customer/joinWelcome">회원가입</a>
                            </li>
                        </ul>
                    </div>
                    <div class="flex-center">
                        <a onclick="login()" class="btn btn-xlg btn-point">로그인</a>
                    </div>
                    <h2 class="font-sm semi-bold center">간편 로그인</h2>
                    <ul class="sns-login-group">
                        <li>
                            <a href="javascript:popNaverLogin();" class="naver-login">네이버</a>
                        </li>
                        <li>
                            <a href="javascript:popKakaoLogin();" class="kakao-login">카카오</a>
                        </li>
                    </ul>
                    <div class="dummy-line"></div>
                    <p class="font-md semi-bold center">비회원 주문조회</p>
                </div>
                <div class="login-right">
                    <img src="https://dummyimage.com/440x440/eee/777" alt="">
                </div>
            </div>
        </div>
    </div>


    <script>
        function login(){
            $.ajax({
              url:'/login.ajax'
              ,type:'post'
              ,data:$('#loginForm').serialize()
            }).done(function(res){
                try{
                    if(res.data.result == '200'){
                        //로그인 성공
                        modal.hide();
                        $('.nosessionClass').hide();
                        $('.sessionClass').show();

                        if (typeof loginRefresh != 'undefined') {
                            location.reload();
                        }
                    }else{
                        //로그인 실패
                        console.log(res.data.result);
                    }
                }catch (e){
                    alert('잠시 후 시도해주세요');
                }
            });
        }
    </script>
    <script>
        /*** 로그인 모달 창 ***/
        var modal = $(".loginModal-wrap");

        $(".login").click(function(){
            $('body').addClass('no-scroll');
            modal.show();
            return false;
        });
        // 모달 창 닫기
        $(".loginModal-close").click(function(){
            $('body').removeClass('no-scroll');
            modal.hide();
        });
        // 외부영역 클릭 시 팝업 닫기
        $(document).mousedown(function (e){
            if(modal.has(e.target).length === 0){
                modal.hide();
                $('body').removeClass('no-scroll');
            } else {
                $('body').addClass('no-scroll');
            }
        });
    </script>
</th:block>

<!--비회원 로그인 모달창-->
<th:block th:fragment="nonMemberLogin-modal">
    <div class="modal-wrap nonMemberLoginModal-wrap">
        <div class="modal nonMemberLoginModal">
            <div class="nonMemberLoginModal-close">
                <img th:attr="src=@{/image/close.png},title='모달창닫기',alt='창닫기'">
            </div>
            <h2 class="font-lg semi-bold center">로그인</h2>
            <form id="nonMemberLoginModalForm" onkeyup="if(event.keyCode==13){nonMemberLoginModalLogin();return false;}">
                <ul class="login-input-group">
                    <li class="input-wrap">
                        <input type="text" class="form-control" name="id" placeholder="아이디">
                    </li>
                    <li class="input-wrap">
                        <input type="password" class="form-control" name="pw" maxlength="20" placeholder="비밀번호">
                    </li>
                </ul>
            </form>
            <div class="login-check-wrap">
                <label class="login-check">
                    <input type="checkbox" class="custom-checkbox">
                    자동로그인
                </label>
                <ul class="login-find-group">
                    <li>
                        <a href="/customer/findCustomer">아이디/비밀번호 찾기</a>
                    </li>
<!--                    <li>-->
<!--                        <a href="/customer/findCustomer">비밀번호 찾기</a>-->
<!--                    </li>-->
                    <li>
                        <a href="/customer/joinWelcome">회원가입</a>
                    </li>
                </ul>
            </div>

            <div class="flex-center">
                <a onclick="nonMemberLoginModalLogin()" class="btn btn-xlg btn-point">로그인</a>
            </div>
            <h2 class="font-sm semi-bold center">간편 로그인</h2>
            <ul class="sns-login-group">
                <li>
                    <a href="javascript:popNaverLogin();" class="naver-login">네이버</a>
                </li>
                <li>
                    <a href="javascript:popKakaoLogin();" class="kakao-login">카카오</a>
                </li>
            </ul>
            <div class="dummy-line"></div>
            <a href="javascript:orderSpoNonMember();" class="btn btn-md btn-gray-outline btn-width-md radius-xlarge">비회원 구매</a>
        </div>
    </div>


    <script>
        function nonMemberLoginModalLogin(){
            $.ajax({
                url:'/login.ajax'
                ,type:'post'
                ,data:$('#nonMemberLoginModalForm').serialize()
            }).done(function(res){
                try{
                    if(res.data.result == '200'){
                        //로그인 성공
                        nonMemberLoginModal.hide();
                        $('.nosessionClass').hide();
                        $('.sessionClass').show();
                    }else{
                        //로그인 실패
                        console.log(res.data.result);
                    }
                }catch (e){
                    alert('잠시 후 시도해주세요');
                }
            });
        }
    </script>
    <script>
        /*** 로그인 모달 창 ***/
        var nonMemberLoginModal = $(".nonMemberLoginModal-wrap");

        // 모달 창 닫기
        $(".nonMemberLoginModal-close").click(function(){
            $('body').removeClass('no-scroll');
            nonMemberLoginModal.hide();
        });
        // 외부영역 클릭 시 팝업 닫기
        $(document).mousedown(function (e){
            if(nonMemberLoginModal.has(e.target).length === 0){
                nonMemberLoginModal.hide();
                $('body').removeClass('no-scroll');
            } else {
                $('body').addClass('no-scroll');
            }
        });
    </script>
</th:block>

<!--배송지목록 모달창-->
<th:block th:fragment="addrList-modal">
    <div class="modal-wrap addrListModal-wrap">
        <div class="modal addrListModal" id="addrListDiv">
            배송지 loading...
        </div>
    </div>

    <script>
        /*** 배송지목록 모달 창 ***/
        var addrListModal = $(".addrListModal-wrap");

        $(".addrListBtn").click(function(){
            // $('body').addClass('no-scroll');

            $('#addrListDiv').html('');
            $.ajax({
              url:'/customer/address.load'
            }).done(function(res){
                $('#addrListDiv').html(res);
                addrListModal.show();
            });

            return false;
        });

        // 외부영역 클릭 시 팝업 닫기
        $(document).mouseup(function (e){
            if(addrListModal.has(e.target).length === 0){
                addrListModal.hide();
                // $('body').removeClass('no-scroll');
            } else {
                // $('body').addClass('no-scroll');
            }
        });
        // ESC 키 누를시 팝업 닫기
        $(document).keydown(function(e){
            //keyCode 구 브라우저, which 현재 브라우저
            var code = e.keyCode || e.which;

            if (code == 27) { // 27은 ESC 키번호
                addrListModal.hide();
                // $('body').removeClass('no-scroll');
            }
        });
    </script>
</th:block>
<th:block th:fragment="addrList-modal-load">
    <h2 class="font-xxxlg semi-bold">배송지 목록</h2>
    <!-- 배송지 테이블 제목 -->
    <ul class="addrList-table-title font-sm">
        <li>배송지명</li>
        <li>주소</li>
        <li>연락처</li>
        <li>선택</li>
    </ul>
    <ul class="addrList-table-cont font-md" th:each="addr : ${addressList}">
        <li>
            <p th:text="${addr.adTitle}">주소명</p>
            <p class="bold" th:text="${addr.adName}">배송자 이름</p>
        </li>
        <li>
            <p th:text="${addr.address.post}">우편번호</p>
            <p class="bold" th:text="${addr.address.address3()}">주소</p>
            <p th:text="${addr.address.addr4}">상세 주소</p>
            <p class="mo-addr-phone pc-display-none" th:text="${addr.adPhoneFormat()}">배송자 연락처(모바일화면)</p>
        </li>
        <li class="font-sm" th:text="${addr.adPhoneFormat()}">배송자 연락처</li>
        <li>
            <div class="btn btn-white select-btn font-xsm">선택</div>
        </li>
    </ul>

    <!-- 팝업 하단 닫기 버튼 -->
    <div class="order-button-group">
        <a href="javascript:;" class="btn btn-md btn-point btn-width-md radius-xlarge addrListClose-btn">닫기</a>
    </div>
    <!-- 팝업 상단 닫기 버튼 -->
    <div class="addrModal-close">
        <img src="/image/close.png" title="모달창닫기" alt="창닫기">
    </div>
    <script>
        // 모달 창 닫기
        $(".addrListClose-btn").click(function(){
            $('body').removeClass('no-scroll');
            addrListModal.hide();
        });
        $(".addrModal-close").click(function(){
            $('body').removeClass('no-scroll');
            addrListModal.hide();
        });
    </script>
</th:block>

<!-- 공통 모달-->
<th:block th:fragment="iamport-modal">
    <div class="modal-wrap" id="iamportModal">
        <div class="modal" style="width: 1000px;height: 800px;padding:0px;">
<!--            <div class="iamportModal-close" style="cursor: pointer; position: absolute; top: 10px; right: 10px; width: 22px; height: 22px;">-->
<!--                <img src="/image/close.png" title="모달창닫기" alt="창닫기">-->
<!--            </div>-->
            <div class="modalContent" id="iamportFrameParent">
            </div>

        </div>
    </div>

    <script>
        var iamportModal = $("#iamportModal");
        function iamportModalShow(id, req){
            $('#iamportFrameParent').append('<iframe id="iamportFrame" src="/orders/iamport" style="width: 100%; height: 800px;"></iframe>');
            iamportModal.show();

            var iamFrame = $('#iamportFrameParent').find('iframe')[0];
            var frameDoc = iamFrame .contentWindow || iamFrame .contentDocument;
            frameDoc.onload = function(){
                frameDoc.req(id, req);
            }
        }
        function iamportModalHide(){
            $('body').removeClass('no-scroll');
            iamportModal.hide();
            $('#iamportFrame').remove();
        }
        $(".iamportModal-close").click(function(){
            iamportModalHide();
        });
    </script>
</th:block>

<!-- 공통 모달-->
<th:block th:fragment="common-modal">
    <div class="modal-wrap" id="commonModal">
        <div class="modal">
            <div class="commonModal-close">
                <i></i>
            </div>
            <div class="modalContent">

            </div>
        </div>
    </div>

    <script>
        var commonModal = $("#commonModal");

        $(document).mouseup(function (e){
            if(commonModal.has(e.target).length === 0){
                commonModal.hide();
                $('body').removeClass('no-scroll');
            } else {
                $('body').addClass('no-scroll');
            }
        });

        $(".commonModal-close").click(function(){
            $('body').removeClass('no-scroll');
            commonModal.hide();
        });
    </script>
</th:block>

<th:block th:fragment="product-modal">
    <div class="modal-wrap" id="productModal">
        <div class="modal">
            <div class="productModal-close">
                <i></i>
            </div>
            <div id="productModalContent">

            </div>
        </div>
    </div>

    <script>
        var modal = $("#productModal");

        $(document).mouseup(function (e){
            if(modal.has(e.target).length === 0){
                modal.hide();
                $('body').removeClass('no-scroll');
            } else {
                $('body').addClass('no-scroll');
            }
        });

        $(".productModal-close").click(function(){
            $('body').removeClass('no-scroll');
            modal.hide();
        });

        // 외부영역 클릭 시 팝업 닫기
        $(document).mousedown(function (e){
            if(modal.has(e.target).length === 0){
                modal.hide();
                $('body').removeClass('no-scroll');
            } else {
                $('body').addClass('no-scroll');
            }
        });
    </script>
</th:block>


